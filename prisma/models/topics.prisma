model Topic {
  id             String    @id @default(cuid())
  guildSnowflake String
  name           String
  summary        String
  createdAt      DateTime  @default(now())
  messages       Message[]
  guild          Guild     @relation(fields: [guildSnowflake], references: [snowflake])
}

model Message {
  guildSnowflake   String
  channelSnowflake String
  messageSnowflake String
  topicId          String
  createdAt        DateTime @default(now())
  guild            Guild    @relation(fields: [guildSnowflake], references: [snowflake])
  topic            Topic    @relation(fields: [topicId], references: [id])

  @@id([guildSnowflake, channelSnowflake, messageSnowflake, topicId])
}


// INTROSPECTED: See `topic_embeddings` migration
model topic_summary_embeddings_store {
  embedding_uuid String                @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  id             String
  chunk_seq      Int
  chunk          String
  embedding      Unsupported("vector")

  @@unique([id, chunk_seq])
}
